# percentage of population affected Pakistan
SELECT DATE, location, total_Cases, population, total_cases/population * 100 as Percentage_AFFECTED 
FROM `spry-ivy-353218.COVID.COVIDT` 
WHERE LOCATION = "Pakistan"
ORDER BY PERCENTAGE_AFFECTED DESC


# percentage of population FULLY VACCINATED PAKISTAN
SELECT DATE, location, PEOPLE_FULLY_VACCINATED, population, PEOPLE_FULLY_VACCINATED/population * 100 as Percentage_VACCINATED 
FROM `spry-ivy-353218.COVID.COVID_DATA` 
WHERE LOCATION = "Pakistan"
ORDER BY PERCENTAGE_VACCINATED DESC


# percentage of DAILY_DEATHS COMAPRED TO DAILY_NEW_CASES  FULLY VACCINATED PAKISTAN
SELECT DATE, location, NEW_CASES, NEW_DEATHS, NEW_deaths/NEW_cases * 100 as Percentage_DAILY_DEATHS  
FROM `spry-ivy-353218.COVID.COVID_DATA` 
WHERE LOCATION = "Pakistan" AND NEW_CASES>0
ORDER BY PERCENTAGE_DAILY_DEATHS DESC

# Total deaths by location BY COUNTRIES  
SELECT  location,MAX(Total_cases) AS TOTAL_DEATHS  
FROM `spry-ivy-353218.COVID.COVID_DATA` 
WHERE LOCATION != "North Korea" AND CONTINENT IS NOT NULL
GROUP BY LOCATION
ORDER BY Location

# Total deaths by location BY CONTINENT 
SELECT  CONTINENT,MAX(Total_cases) AS TOTAL_DEATHS  
FROM `spry-ivy-353218.COVID.COVID_DATA` 
WHERE LOCATION != "North Korea" AND CONTINENT IS NOT NULL
GROUP BY CONTINENT
ORDER BY CONTINENT

#Highest infection rates GLOBAL
SELECT MAX(total_cases_per_million) AS TOTAL_CASES_PER_MILLION , location
FROM `spry-ivy-353218.COVID.COVID_DATA`
WHERE LOCATION != "North Korea" AND CONTINENT IS NOT NULL
GROUP BY LOCATION 
ORDER BY total_cases_per_million DESC

#HIGHEST DEATH RATE  GLOBAL
SELECT MAX(total_DEATHS_per_million) AS TOTAL_DEATHS_PER_MILLION , location
FROM `spry-ivy-353218.COVID.COVID_DATA`
WHERE LOCATION != "North Korea" AND CONTINENT IS NOT NULL
GROUP BY LOCATION 
ORDER BY total_DEATHS_per_million DESC

#DEATH RATE WITH RESPECT TO INFECTION RATE  GLOBAL
SELECT MAX(total_DEATHS_per_million)/MAX(TOTAL_CASES_PER_MILLION)*100 AS PERC_of_Deaths_WRT_Infection , location
FROM `spry-ivy-353218.COVID.COVID_DATA`
WHERE LOCATION != "North Korea" AND CONTINENT IS NOT NULL
GROUP BY LOCATION 
ORDER BY PERC_of_Deaths_WRT_Infection DESC

SELECT MAX(total_DEATHS_per_million)  , MAX(total_CASES_per_million) , location , continent
FROM `spry-ivy-353218.COVID.COVID_DATA`
WHERE location= "Asia"
GROUP BY LOCATION , CONTINENT
